"use strict";(self.webpackChunkdev_site_documentation_template=self.webpackChunkdev_site_documentation_template||[]).push([[318],{30594:function(e,t,n){n.r(t),n.d(t,{_frontmatter:function(){return d},default:function(){return h}});var o=n(58168),i=n(80045),a=(n(88763),n(15680)),r=n(83407);const s=["components"],d={},l={_frontmatter:d},p=r.A;function h(e){let{components:t}=e,n=(0,i.A)(e,s);return(0,a.mdx)(p,(0,o.A)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,a.mdx)("h1",{id:"using-webhooks-through-adobe-io-events"},"Using webhooks through Adobe I/O Events"),(0,a.mdx)("p",null,"Use webhooks with Adobe Lightroom API through Adobe I/O Events."),(0,a.mdx)("p",null,"Adobe I/O Events offers the possibility to build an event-driven application, based on events originating from Lightroom and Lightroom APIs. To start listening for events, your application needs to register a webhook URL, specifying the Event Types to receive. Whenever a matching event gets triggered, your application is notified through an HTTP POST request to the webhook URL."),(0,a.mdx)("p",null,"The Event Provider for Lightroom and Lightroom APIs is ",(0,a.mdx)("inlineCode",{parentName:"p"},"Imaging API Events"),". This event provider has two event types:"),(0,a.mdx)("ol",null,(0,a.mdx)("li",{parentName:"ol"},(0,a.mdx)("inlineCode",{parentName:"li"},"Lightroom API events")),(0,a.mdx)("li",{parentName:"ol"},(0,a.mdx)("inlineCode",{parentName:"li"},"Lightroom API events"))),(0,a.mdx)("p",null,"As the names indicate, these event types represent events triggered by the individual APIs."),(0,a.mdx)("h2",{id:"registering-your-application-to-our-event-provider"},"Registering your application to our event provider"),(0,a.mdx)("p",null,"Prerequisites needed to use the Event Provider:"),(0,a.mdx)("ol",null,(0,a.mdx)("li",{parentName:"ol"},"In order to use the Adobe I/O Events you will need to create a project on Adobe I/O Console. ",(0,a.mdx)("a",{parentName:"li",href:"../../getting_started/"},"Follow the steps listed in Getting Started page to create a project")," if you haven't created one yet."),(0,a.mdx)("li",{parentName:"ol"},"Learn ",(0,a.mdx)("a",{parentName:"li",href:"https://www.adobe.io/apis/experienceplatform/events/docs.html#!adobedocs/adobeio-events/master/intro/webhooks_intro.md"},"more about creating a Webhook application.")," This page provides all of the details you will need to build a basic application."),(0,a.mdx)("li",{parentName:"ol"},"To register the webhook to the service integration, ",(0,a.mdx)("a",{parentName:"li",href:"https://developer.adobe.com/events/docs/guides/#getting-started"},"use the steps in the guided introduction to Adobe I/O Events"),".")),(0,a.mdx)("p",null,"After the webhook has been successfully registered, you'll receive the events for any submitted job that either succeeded or failed, from the event types that are selected. This eliminates the need for your application to poll for the status of the job using the job ID."),(0,a.mdx)("h2",{id:"triggering-an-event-from-the-apis"},"Triggering an event from the APIs"),(0,a.mdx)("p",null,"To start receiving the events in your webhook application, pass your IMS organization ID in the header:"),(0,a.mdx)("pre",null,(0,a.mdx)("code",{parentName:"pre",className:"language-shell"}," -H 'x-gw-ims-org-id: ${IMS_ORG_ID}'  \\\n")),(0,a.mdx)("p",null," The example below demonstrates using this header in an Auto Tone job and a sample event received for that job."),(0,a.mdx)("h3",{id:"step-1-initiating-the-job"},"Step 1: Initiating the job"),(0,a.mdx)("p",null,"This initiates the Auto Tone job using the header to trigger an event."),(0,a.mdx)("pre",null,(0,a.mdx)("code",{parentName:"pre",className:"language-shell"},'curl -X POST \\\n  https://image.adobe.io/lrService/autoTone \\\n  -H "Authorization: Bearer ${TOKEN}" \\\n  -H "Content-Type: application/json" \\\n  -H "x-api-key: ${API_KEY}" \\\n  -H "x-gw-ims-org-id: ${IMS_ORG_ID}" \\\n  -d \'{\n    "inputs": {\n      "href": "<SIGNED_GET_URL>",\n      "storage": "<STORAGE_LOCATION>"\n    },\n    "outputs": [\n    {\n      "href": "<SIGNED_POST_URL>",\n      "type": "<TYPE>",\n      "storage": "<STORAGE_LOCATION>"\n    }\n  ]\n}\'\n')),(0,a.mdx)("p",null,"The asynchronous job returns a response containing the ",(0,a.mdx)("inlineCode",{parentName:"p"},"href")," to poll for the job status."),(0,a.mdx)("pre",null,(0,a.mdx)("code",{parentName:"pre",className:"language-json"},'{\n    "_links": {\n        "self": {\n            "href": "https://image.adobe.io/lrService/status/eb4a9211-eb8a-4e88-b853-b9c08ba47427"\n        }\n    }\n}\n')),(0,a.mdx)("h3",{id:"step-2-retrieve-the-jobs-status-on-the-webhook-application-when-the-job-is-complete"},"Step 2: Retrieve the job's status on the webhook application when the job is complete"),(0,a.mdx)("p",null,"The ",(0,a.mdx)("inlineCode",{parentName:"p"},"body")," property in the ",(0,a.mdx)("inlineCode",{parentName:"p"},"event")," object contains the result of the job, as in this example:"),(0,a.mdx)("pre",null,(0,a.mdx)("code",{parentName:"pre",className:"language-json"},'{\n  "event_id": "7b59cc70-88d7-4895-b204-87f5350a0cce",\n  "event": {\n    "header": {\n      "msgType": "JOB_COMPLETION_STATUS",\n      "msgId": "eb4a9211-eb8a-4e88-b853-b9c08ba47427",\n      "imsOrgId": "<IMS org ID>",\n      "eventCode": "lightroom-job-status",\n      "_pipelineMeta": {\n        "pipelineMessageId": "1586290300876:944289:VA7_A1:149:0"\n      },\n      "_smarts": {\n        "definitionId": "3ee6c9056a9d72fc40e09ddf5fdbb0af752e8e49",\n        "runningSmartId": "psmart-yw6wosjksniuuathenny"\n      },\n      "_adobeio": {\n        "imsOrgId": "<IMS org ID>",\n        "providerMetadata": "di_event_code",\n        "eventCode": "lightroom-job-status"\n      }\n    },\n    "body": {\n      "jobId": "eb4a9211-eb8a-4e88-b853-b9c08ba47427",\n      "outputs": [\n        {\n          "input": "<signed GET URL>",\n          "status": "succeeded",\n          "_links": {\n            "self": [\n              {\n                "href": "<signed POST URL>",\n                "storage": "<storage>"\n              }\n            ]\n          }\n        }\n      ],\n      "_links": {\n        "self": {\n          "href": "https://image.adobe.io/lrService/status/eb4a9211-eb8a-4e88-b853-b9c08ba47427"\n        }\n      }\n    }\n  }\n}\n')))}h.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-use-webhooks-index-md-ac3988bf19d9748c23b4.js.map